{"ast":null,"code":"var _jsxFileName = \"C:\\\\Studia\\\\React\\\\XD\\\\React_Project\\\\src\\\\js\\\\Booking.js\";\nimport React from 'react';\nimport { withRouter } from \"react-router-dom\";\nimport Details from './Details';\nimport '../css/Booking.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nclass Booking extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.buttonHandler = () => {\n      this.setState(prevState => ({\n        showDetails: !prevState.showDetails\n      }));\n      this.loadDetails();\n    };\n\n    this.getCookieValue = key => {\n      return document.cookie.replace(`/(?:(?:^|.*;\\s*)${key}\\s*\\=\\s*([^;]*).*$)|^.*$/, \"$1\"`).split(\"=\")[1];\n    };\n\n    props.booking.start_date = new Date(props.booking.start_date);\n    this.state = {\n      showDetails: false,\n      detailsLoaded: false,\n      detailsLoading: false,\n      details: null,\n      error: false\n    };\n    this.buttonHandler = this.buttonHandler.bind(this);\n    this.loadDetails = this.loadDetails.bind(this);\n  }\n\n  loadDetails() {\n    if (this.state.detailsLoaded) {\n      return;\n    }\n\n    this.setState({\n      detailsLoading: true\n    }); //console.log(this.props.booking.type)\n\n    fetch(`http://minibookly.us-east-1.elasticbeanstalk.com/bookings/${this.props.booking.id}`, {\n      method: 'GET',\n      headers: {\n        'Authorization': `Bearer ${this.getCookieValue('token')}`\n      }\n    }).then(response => {\n      if (response.status === 200) {\n        return response.json();\n      } else if (response.status === 403) {\n        alert('You have been logged out of your session, please login in again!');\n        document.cookie = \"token=; expires=Thu, 01 Jan 1970 00:00:01 GMT;\";\n        this.props.history.push(\"/\");\n      } else {\n        this.setState({\n          error: true\n        });\n      }\n    }).then(data => {\n      if (!this.state.error) {\n        this.setState({\n          details: data\n        });\n      }\n    }).then(() => this.setState({\n      detailsLoading: false,\n      detailsLoaded: true\n    }));\n  }\n\n  render() {\n    const booking = this.props.booking; // const myButton = (\n    //   <button onClick={this.buttonHandler}>XD</button>\n    // )\n\n    const error = React.createElement(\"div\", {\n      style: {\n        margin: \"1%\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }, \"There has been an error while loading the details.\", React.createElement(\"button\", {\n      onClick: this.loadDetails,\n      className: \"btn-primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    }, \"X Retry D\"));\n    const preDetails = this.state.detailsLoading ? React.createElement(\"div\", {\n      style: {\n        margin: \"1%\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"spinner-border text-dark\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    })) : !this.state.error ? React.createElement(Details, {\n      data: this.state.details,\n      itemType: booking.type,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }) : error;\n    return React.createElement(\"div\", {\n      className: \"card cardxd bg-light text-dark\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"card-header cardClickable\",\n      onClick: this.buttonHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-md-6\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-md-3 text-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, booking.id), React.createElement(\"div\", {\n      className: \"col-md-3 text-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }, booking.owner), React.createElement(\"div\", {\n      className: \"col-md-3 text-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, booking.username), React.createElement(\"div\", {\n      className: \"col-md-3 text-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, booking.itemId))), React.createElement(\"div\", {\n      className: \"col-md-6\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-md-3 text-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, booking.itemType), React.createElement(\"div\", {\n      className: \"col-md-3 text-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, booking.details), React.createElement(\"div\", {\n      className: \"col-md-3 text-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, booking.active.toString()), React.createElement(\"div\", {\n      className: \"col-md-3 text-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, booking.startDateTime))))), this.state.showDetails && preDetails);\n  }\n\n}\n\nexport default withRouter(Booking); // {this.element(booking.booking_id)}\n// {this.element(booking.user_id)}\n// {this.element(booking.username)}\n// {this.element(booking.item_id)}\n// {this.element(booking.type)}\n// {this.element(booking.item_info)}\n// {this.element(booking.active.toString())}\n// {this.element(`${booking.start_date.getDate()} \n//   ${booking.start_date.getMonth() + 1} ${booking.start_date.getFullYear()}`)}","map":{"version":3,"sources":["C:/Studia/React/XD/React_Project/src/js/Booking.js"],"names":["React","withRouter","Details","Booking","Component","constructor","props","buttonHandler","setState","prevState","showDetails","loadDetails","getCookieValue","key","document","cookie","replace","split","booking","start_date","Date","state","detailsLoaded","detailsLoading","details","error","bind","fetch","id","method","headers","then","response","status","json","alert","history","push","data","render","margin","preDetails","type","owner","username","itemId","itemType","active","toString","startDateTime"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { withRouter } from \"react-router-dom\";\r\nimport Details from './Details'\r\nimport '../css/Booking.css';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\n\r\nclass Booking extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    props.booking.start_date = new Date(props.booking.start_date);\r\n    this.state = {\r\n      showDetails: false,\r\n      detailsLoaded: false,\r\n      detailsLoading: false,\r\n      details: null,\r\n      error: false\r\n    }\r\n    this.buttonHandler = this.buttonHandler.bind(this)\r\n    this.loadDetails = this.loadDetails.bind(this)\r\n  }\r\n\r\n  buttonHandler = () => {\r\n    this.setState(prevState => ({\r\n      showDetails: !prevState.showDetails\r\n    }))\r\n    this.loadDetails();\r\n  }\r\n  getCookieValue = (key) => {\r\n    return document.cookie.replace(`/(?:(?:^|.*;\\s*)${key}\\s*\\=\\s*([^;]*).*$)|^.*$/, \"$1\"`).split(\"=\")[1];\r\n  }\r\n  loadDetails() {\r\n    if (this.state.detailsLoaded) {\r\n      return;\r\n    }\r\n    this.setState({\r\n      detailsLoading: true\r\n    });\r\n    //console.log(this.props.booking.type)\r\n    fetch(`http://minibookly.us-east-1.elasticbeanstalk.com/bookings/${this.props.booking.id}`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': `Bearer ${this.getCookieValue('token')}`\r\n      }\r\n    })\r\n      .then(response => {\r\n        if (response.status === 200) {\r\n          return response.json();\r\n        } else if (response.status === 403) {\r\n          alert('You have been logged out of your session, please login in again!');\r\n          document.cookie = \"token=; expires=Thu, 01 Jan 1970 00:00:01 GMT;\"\r\n          this.props.history.push(\"/\");\r\n        } else {\r\n          this.setState({ error: true })\r\n        }\r\n      })\r\n      .then(data => {\r\n        if (!this.state.error) {\r\n          this.setState({ details: data })\r\n        }\r\n      })\r\n      .then(() => this.setState({ detailsLoading: false, detailsLoaded: true }));\r\n  }\r\n\r\n  render() {\r\n    const { booking } = this.props\r\n\r\n    // const myButton = (\r\n    //   <button onClick={this.buttonHandler}>XD</button>\r\n    // )\r\n\r\n    const error = (\r\n      <div style={{ margin: \"1%\" }}>\r\n        There has been an error while loading the details.\r\n        <button onClick={this.loadDetails} className=\"btn-primary\">X Retry D</button>\r\n      </div>\r\n    )\r\n\r\n    const preDetails = (\r\n      this.state.detailsLoading\r\n        ? <div style={{ margin: \"1%\" }}><div className=\"spinner-border text-dark\"></div></div>\r\n        : !this.state.error ? <Details data={this.state.details} itemType={booking.type} /> : error\r\n    )\r\n\r\n    return (\r\n      <div className=\"card cardxd bg-light text-dark\">\r\n        <div className=\"card-header cardClickable\" onClick={this.buttonHandler}>\r\n          <div className=\"row\">\r\n            <div className=\"col-md-6\">\r\n              <div className=\"row\">\r\n                <div className=\"col-md-3 text-left\">\r\n                  {booking.id}\r\n                </div>\r\n                <div className=\"col-md-3 text-left\">\r\n                  {booking.owner}\r\n                </div>\r\n                <div className=\"col-md-3 text-left\">\r\n                  {booking.username}\r\n                </div>\r\n                <div className=\"col-md-3 text-left\">\r\n                  {booking.itemId}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"col-md-6\">\r\n              <div className=\"row\">\r\n                <div className=\"col-md-3 text-left\">\r\n                  {booking.itemType}\r\n                </div>\r\n                <div className=\"col-md-3 text-left\">\r\n                  {booking.details}\r\n                </div>\r\n                <div className=\"col-md-3 text-left\">\r\n                  {booking.active.toString()}\r\n                </div>\r\n                <div className=\"col-md-3 text-left\">\r\n                  {booking.startDateTime}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        {this.state.showDetails && preDetails}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(Booking)\r\n\r\n// {this.element(booking.booking_id)}\r\n// {this.element(booking.user_id)}\r\n// {this.element(booking.username)}\r\n// {this.element(booking.item_id)}\r\n// {this.element(booking.type)}\r\n// {this.element(booking.item_info)}\r\n// {this.element(booking.active.toString())}\r\n// {this.element(`${booking.start_date.getDate()} \r\n//   ${booking.start_date.getMonth() + 1} ${booking.start_date.getFullYear()}`)}"]},"metadata":{},"sourceType":"module"}